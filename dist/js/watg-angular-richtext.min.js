/*! watg-angular-richtext 2015-07-31 */
var watgRichtext=angular.module("watgRichtext",["ngSanitize","watgRichtext.templates"]).config(function(){});watgRichtext.directive("watgRichtextEditor",function(){return{restrict:"E",templateUrl:"app/templates/watgRichtextEditorTemplate.html",scope:{richText:"=richText",variables:"=",fontFamilies:"=",fontSizes:"=",colors:"="},link:function(scope,element){var editor,editorDoc,editorHead,editorBody,watchCounter=0;scope.menuEnabled=!1,scope.$watch("richText",function(){scope.richText&&0===watchCounter&&(editorDoc.body.innerHTML=scope.richText,watchCounter++),scope.richText?scope.menuEnabled=!0:scope.menuEnabled=!1}),scope.$watch("variables",function(){}),scope.$watch("fontFamilies",function(){}),scope.$watch("fontSizes",function(){}),scope.$watch("colors",function(){}),console.log(scope.variables),console.log(scope.fontFamilies),console.log(scope.fontSizes),console.log(scope.colors),scope.initialize=function(){editor=element.find("iframe")[0],editor?(editorDoc=editor.contentDocument?editor.contentDocument:editor.contentWindow.document,editorHead=editorDoc.head,null!=editorHead&&(editorHead.innerHTML="<link href='../dev/css/vendor.min.css' rel='stylesheet'/>"),editorBody=editorDoc.body,"spellcheck"in editorBody&&(editorBody.spellcheck=!1),"contentEditable"in editorBody?editorBody.contentEditable=!0:"designMode"in editorDoc&&(editorDoc.designMode="on"),scope.richText&&(editorDoc.body.innerHTML=scope.richText),$(editor.contentWindow.document).keyup(function(){scope.update()}),$(editor.contentWindow.document).blur(function(){scope.update()})):console.error("Rich-text editor not found")},scope.update=function(){try{scope.richText=editorDoc.body.innerHTML,scope.$apply()}catch(e){}},scope.applyRichText=function(action,details){try{console.log("Action "+action+" Details "+details),editorDoc.execCommand(action,!1,details),scope.update()}catch(e){}},scope.createLink=function(){console.log("create link")},scope.initialize()}}});